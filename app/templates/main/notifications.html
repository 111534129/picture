{% extends "base.html" %}

{% block content %}
<div class="notifications-container" style="max-width: 800px; margin: 0 auto;">
    <h2>
        通知中心
        <span style="font-size: 0.6em; color: gray; font-weight: normal;">(點擊即可標記為已讀)</span>
    </h2>
    <hr>

    {% if notifications %}
    <div class="list-group">
        {% for note in notifications %}
        <a href="{{ url_for('main.mark_read', id=note.id) }}" class="list-group-item list-group-item-action"
            style="display: flex; align-items: center; gap: 15px; padding: 15px; border-bottom: 1px solid #eee; text-decoration: none; color: inherit; background-color: {% if note.is_read %}#fff{% else %}#f0f8ff{% endif %};">

            <!-- Avatar -->
            <div style="flex-shrink: 0;">
                {% if note.type == 'system' %}
                <div
                    style="width: 50px; height: 50px; border-radius: 50%; background-color: #dc3545; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; color: white;">
                    !
                </div>
                {% elif note.author.avatar %}
                <img src="{{ url_for('static', filename='uploads/' + note.author.avatar) }}"
                    style="width: 50px; height: 50px; border-radius: 50%; object-fit: cover;">
                {% else %}
                <div
                    style="width: 50px; height: 50px; border-radius: 50%; background-color: #ddd; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; color: #777;">
                    {{ note.author.username[0] | upper }}
                </div>
                {% endif %}
            </div>

            <!-- Content -->
            <div style="flex-grow: 1;">
                <div>
                    <strong>{{ note.author.username }}</strong>
                    {% if note.type == 'follow' %}
                    開始追蹤您了。
                    {% elif note.type == 'like' %}
                    按讚了您的照片。
                    {% elif note.type == 'comment' %}
                    在您的照片留言。
                    {% elif note.type == 'comment_reply' %}
                    回覆了您的留言。
                    {% elif note.type == 'new_album' %}
                    建立了新相簿。
                    {% elif note.type == 'new_photo' %}
                    上傳了新照片。
                    {% elif note.type == 'mention' %}
                    在照片留言中標記了您。
                    {% elif note.type == 'system' %}
                    <span style="color: #dc3545;">{{ note.payload }}</span>
                    {% endif %}
                </div>
                <small style="color: gray;">{{ note.timestamp.strftime('%Y-%m-%d %H:%M') }}</small>
            </div>

            <!-- Indicator -->
            {% if not note.is_read %}
            <div style="width: 10px; height: 10px; background-color: #007bff; border-radius: 50%;"></div>
            {% endif %}
        </a>
        {% endfor %}
    </div>
    {% else %}
    <p style="text-align: center; color: gray; margin-top: 50px;">目前沒有任何通知。</p>
    {% endif %}
</div>
{% endblock %}